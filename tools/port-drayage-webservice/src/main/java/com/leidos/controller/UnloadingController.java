package com.leidos.controller;

import com.baeldung.openapi.api.UnloadingApi;
import com.baeldung.openapi.model.ActionStatusList;
import com.baeldung.openapi.model.ContainerActionStatus;
import com.baeldung.openapi.model.ContainerRequest;
import com.leidos.unloading.UnloadingActions;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.RestController;

/**
 * {@link RestController} for all /unloading REST API endpoints. Implements
 * {@link Unloading} interface generated by openapi codegen to define methods of
 * endpoint responses.
 * 
 * @author Paul Bourelly
 */
@RestController
public class UnloadingController implements UnloadingApi {

    Logger logger = LoggerFactory.getLogger(UnloadingController.class);

    /**
     * Injected {@link UnloadingActions} Spring Bean
     */
    @Autowired
    UnloadingActions unloadingActions;

    /**
     * {@inheritDoc}
     */
    @Override
    public ResponseEntity<ActionStatusList> unloadingPendingGet() {
        return ResponseEntity.ok(unloadingActions.getPendingActions());

    }

    /**
     * {@inheritDoc}
     */
    @Override
    public ResponseEntity<ContainerActionStatus> unloadingVehicleIdGet(String vehicleId) {
        ContainerActionStatus action = unloadingActions.getContainerActionStatus(vehicleId);
        logger.debug(String.format("Found action %s!", action));
        if (action != null)
            return ResponseEntity.ok(action);
        return new ResponseEntity<ContainerActionStatus>(HttpStatus.BAD_REQUEST);
    }

    /**
     * {@inheritDoc}
     */
    @Override
    public ResponseEntity<Void> unloadingPost(ContainerRequest request) {
        unloadingActions.requestUnloadingAction(request);
        return new ResponseEntity<>(HttpStatus.CREATED);

    }
}
